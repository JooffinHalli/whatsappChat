openapi: 3.0.2

info:
  title: WhatsAppChatApi
  description: –û–ø–∏—Å–∞–Ω–∏–µ API –¥–ª—è —Å–µ—Ä–≤–∏—Å–∞ WhatsAppChatApi
  version: 0.0.1

externalDocs:
  description: –°—Å—ã–ª–∫–∞ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é GREEN API
  url: https://site.sw.slonbook.com/docs/
    
tags:
  - name: Account
    description: –ú–µ—Ç–æ–¥—ã —Ä–∞–±–æ—Ç—ã —Å –∞–∫–∫–∞—É–Ω—Ç–æ–º
  - name: Sending
    description: –ú–µ—Ç–æ–¥—ã –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
  - name: Receiving
    description: –ú–µ—Ç–æ–¥—ã –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π

paths:
  /getStateInstance:
    get:
      tags:
        - "Account"
      operationId: getStateInstance
      summary: –ú–µ—Ç–æ–¥ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞.
      description: –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è - https://green-api.com/docs/api/account/GetStateInstance/
      responses:
        200:
          $ref: "#/components/responses/getStateInstance"
        400:
          $ref: "#/components/responses/Error400"
        429:
          $ref: "#/components/responses/Error429"
        466:
          $ref: "#/components/responses/Error466"
        500:
          $ref: "#/components/responses/Error500"
  /getSettings:
    get:
      tags:
        - "Account"
      operationId: getSettings
      summary: The method is aimed for getting the current account settings.
      description: –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è - https://green-api.com/en/docs/api/account/GetSettings/
      responses:
        200:
          $ref: "#/components/responses/getSettings"
        400:
          $ref: "#/components/responses/Error400"
        429:
          $ref: "#/components/responses/Error429"
        466:
          $ref: "#/components/responses/Error466"
        500:
          $ref: "#/components/responses/Error500"
  /sendMessage:
    post:
      tags:
        - "Sending"
      operationId: sendMessage
      summary: –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
      description: –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è - https://green-api.com/docs/api/sending/SendMessage/
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/sendMessageDto"
      responses:
        200:
          $ref: "#/components/responses/sendMessage"
        400:
          $ref: "#/components/responses/Error400"
        429:
          $ref: "#/components/responses/Error429"
        466:
          $ref: "#/components/responses/Error466"
        500:
          $ref: "#/components/responses/Error500"
  /receiveNotification:
    get:
      tags:
        - "Receiving"
      operationId: receiveNotification
      summary: –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
      description: –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è - https://green-api.com/docs/api/receiving/technology-http-api/ReceiveNotification/
      responses:
        200:
          $ref: "#/components/responses/receiveNotification"
        400:
          $ref: "#/components/responses/Error400"
        429:
          $ref: "#/components/responses/Error429"
        466:
          $ref: "#/components/responses/Error466"
        500:
          $ref: "#/components/responses/Error500"
  /deleteNotification/{receiptId}:
    delete:
      tags:
        - "Receiving"
      operationId: deleteNotification
      summary: –£–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ –æ—á–µ—Ä–µ–¥–∏ (–æ—Ç–º–µ—Ç–∏—Ç—å –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ–µ)
      description: –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è - https://green-api.com/en/docs/api/receiving/technology-http-api/DeleteNotification/
      parameters:
        - $ref: "#/components/parameters/receiptId"
      responses:
        200:
          $ref: "#/components/responses/deleteNotification"
        400:
          $ref: "#/components/responses/Error400"
        429:
          $ref: "#/components/responses/Error429"
        466:
          $ref: "#/components/responses/Error466"
        500:
          $ref: "#/components/responses/Error500"

#  -------------------------------------------------------------------------------------------------------------------

components:
  parameters:
    receiptId:
      name: receiptId
      in: path
      description: Receipt Id for deleting an incoming notification received by ReceiveNotification method
      required: true
      schema:
        type: integer

  responses:
    getStateInstance:
      description: –û—Ç–≤–µ—Ç –º–µ—Ç–æ–¥–∞ getStateInstance
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/getStateInstanceRes"
    getSettings:
      description: –û—Ç–≤–µ—Ç –º–µ—Ç–æ–¥–∞ getSettings
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/getSettingsRes"
    sendMessage:
      description: –û—Ç–≤–µ—Ç –º–µ—Ç–æ–¥–∞ sendMessage
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/sendMessageRes"
    receiveNotification:
      description: –û—Ç–≤–µ—Ç –º–µ—Ç–æ–¥–∞ receiveNotification
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/receiveNotificationRes"
    deleteNotification:
      description: –û—Ç–≤–µ—Ç –º–µ—Ç–æ–¥–∞ deleteNotification
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/deleteNotificationRes"

    Error400:
      description: bad request data
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorModel"
    Error429:
      description: Too Many Requests
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorModel"
    Error466:
      description: correspondentsStatus
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorModel"
    Error500:
      description: "File from url exceeded max upload size. Size: XXXXmb Limit: 100mb Url:"
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorModel"

  schemas:
    sendMessageDto:
      title: sendMessageDto
      type: object
      description: –¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è –º–µ—Ç–æ–¥–∞ sendMessage
      required:
        - "chatId"
        - "message"
      properties:
        chatId:
          type: string
          description: –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —á–∞—Ç–∞
        message:
          type: string
          description: –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Å–∏–º–≤–æ–ª—ã emoji üòÉ
        quotedMessageId:
          type: string
          description: –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ü–∏—Ç–∏—Ä—É–µ–º–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è,–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω —Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—Å—è —Å —Ü–∏—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è —á–∞—Ç–∞
        archiveChat:
          type: string
          description: "–ü–æ–º–µ—â–∞–µ—Ç –≤ –∞—Ä—Ö–∏–≤ —á–∞—Ç, –≤ –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ. –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è: true"
        linkPreview:
          type: string
          description: "–ü–∞—Ä–∞–º–µ—Ç—Ä –≤–∫–ª—é—á–∞–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–µ–≤—å—é –∏ –æ–ø–∏—Å–∞–Ω–∏–µ —Å—Å—ã–ª–∫–∏. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤–∫–ª—é—á–µ–Ω. –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è: true/false"
    getChatHistoryDto:
      title: getChatHistoryDto
      type: object
      required:
        - "chatId"
        - "count"
      properties:
        chatId:
          type: string
          description: Personal or chat Id the message history of which you need to get
        count:
          type: integer
          description: The number of messages to get. The default is 100
      example:
        chatId: "11001234567@c.us"
        count: 10

    getStateInstanceRes:
      title: getStateInstanceRes
      type: object
      required:
        - "stateInstance"
      properties:
        stateInstance:
          type: string
          enum:
            - "notAuthorized"
            - "authorized"
            - "blocked"
            - "sleepMode"
            - "starting"
          description: –°–æ—Å—Ç–æ—è–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞
    getSettingsRes:
      title: getSettingsRes
      type: object
      required:
        - "wid"
      properties:
        wid:
          type: string
          description: Account ID in WhatsApp
        countryInstance:
          type: string
          description: Account country code in accordance with standard ISO 3166-2
        typeAccount:
          type: string
          description: "Account type, possible variants: trial, production, vip"
        webhookUrl:
          type: string
          description: URL to receive incoming notifications
        webhookUrlToken:
          type: string
          description: Token for connecting to your webhook server
        delaySendMessagesMilliseconds:
          type: integer
          description: Message sending delay is in milliseconds
        markIncomingMessagesReaded:
          type: string
          enum:
            - "yes"
            - "no"
          description: "Mark incoming messages as read or not, possible variants: yes, no. Ignored if markIncomingMessagesReadedOnReply is 'yes'."
        markIncomingMessagesReadedOnReply:
          type: string
          enum:
            - "yes"
            - "no"
          description: "Mark incoming messages as read when sending a message to the chat via API, possible variants: yes, no. If 'yes', then markIncomingMessagesReaded setting is ignored."
        outgoingWebhook:
          type: string
          enum:
            - "yes"
            - "no"
          description: "Get notifications about outgoing messages sending / delivering / reading status, possible variants: yes, no"
        outgoingMessageWebhook:
          type: string
          enum:
            - "yes"
            - "no"
          description: "Get notifications about messages sent from phone, possible variants: yes, no"
        stateWebhook:
          type: string
          enum:
            - "yes"
            - "no"
          description: "Get notifications about changes in the account authorization status, possible variants: yes, no"
        incomingWebhook:
          type: string
          enum:
            - "yes"
            - "no"
          description: "Get notifications about incoming messages and files, possible variants: yes, no"
        deviceWebhook:
          type: string
          enum:
            - "yes"
            - "no"
          description: "Get notifications about the device (phone) and battery level, possible variants: yes, no"
        statusInstanceWebhook:
          type: string
          enum:
            - "yes"
            - "no"
          description: "Get notifications about the account socket connection status change, possible variants: yes, no"
        sendFromUTC:
          type: string
          description: "Get the account setting - the delay of sending from the queue within the time interval AFTER the specified one (Attention, the time is indicated in UTC), possible variants: 09:00"
        sendToUTC:
          type: string
          description: "Get the account setting - the delay of sending from the queue within the time interval BEFORE the specified one (Attention, the time is indicated in UTC), possible variants: 12:00"
        sharedSession:
          type: string
          description: "–≠—Ç–æ –ø–æ–ª–µ –Ω–µ –æ–ø–∏—Å–∞–Ω–æ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏, –Ω–æ –ø–æ —Ñ–∞–∫—Ç—É –º–æ–∂–µ—Ç –ø—Ä–∏–π—Ç–∏"
        proxyInstance:
          type: string
          description: "–≠—Ç–æ –ø–æ–ª–µ –Ω–µ –æ–ø–∏—Å–∞–Ω–æ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏, –Ω–æ –ø–æ —Ñ–∞–∫—Ç—É –º–æ–∂–µ—Ç –ø—Ä–∏–π—Ç–∏"
        outgoingAPIMessageWebhook:
          type: string
          description: "–≠—Ç–æ –ø–æ–ª–µ –Ω–µ –æ–ø–∏—Å–∞–Ω–æ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏, –Ω–æ –ø–æ —Ñ–∞–∫—Ç—É –º–æ–∂–µ—Ç –ø—Ä–∏–π—Ç–∏"
        enableMessagesHistory:
          type: string
          description: "–≠—Ç–æ –ø–æ–ª–µ –Ω–µ –æ–ø–∏—Å–∞–Ω–æ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏, –Ω–æ –ø–æ —Ñ–∞–∫—Ç—É –º–æ–∂–µ—Ç –ø—Ä–∏–π—Ç–∏"
        keepOnlineStatus:
          type: string
          description: "–≠—Ç–æ –ø–æ–ª–µ –Ω–µ –æ–ø–∏—Å–∞–Ω–æ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏, –Ω–æ –ø–æ —Ñ–∞–∫—Ç—É –º–æ–∂–µ—Ç –ø—Ä–∏–π—Ç–∏"
    sendMessageRes:
      title: sendMessageRes
      type: object
      required:
        - "idMessage"
      properties:
        idMessage:
          type: string
          description: –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
      example:
        idMessage: "1"
    receiveNotificationRes:
      title: receiveNotificationRes
      type: object
      required:
        - "receiptId"
        - "body"
      properties:
        receiptId:
          type: integer
          description: –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –¥–æ—Å—Ç–∞–≤–∫–∏ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –≤—Ö–æ–¥—è—â–µ–≥–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –º–µ—Ç–æ–¥–æ–º DeleteNotification
        body:
          type: object
          description: –í—Ö–æ–¥—è—â–µ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å–æ–≥–ª–∞—Å–Ω–æ –§–æ—Ä–º–∞—Ç—É –≤—Ö–æ–¥—è—â–∏—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
          properties:
            typeWebhook:
              type: string
            sendByApi:
              type: boolean
            status:
              type: string
            instanceData:
              type: object
              required:
                - "idInstance"
                - "wid"
                - "typeInstance"
              properties:
                idInstance:
                  type: integer
                wid:
                  type: string
                typeInstance:
                  type: string
            timestamp:
              type: integer
            idMessage:
              type: string
            senderData:
              type: object
              required:
                - "chatId"
                - "sender"
                - "senderName"
                - "chatName"
              properties:
                chatId:
                  type: string
                sender:
                  type: string
                senderName:
                  type: string
                chatName:
                  type: string
            messageData:
              type: object
              required:
                - "typeMessage"
              properties:
                typeMessage:
                  type: string
                textMessageData:
                  type: object
                  required:
                    - "textMessage"
                  properties:
                    textMessage:
                      type: string
                fileMessageData:
                  type: object
                  properties:
                    caption:
                      type: string
                    downloadUrl:
                      type: string
                    fileName:
                      type: string
                    jpegThumbnail:
                      type: string
                    mimeType:
                      type: string
      example:
        receiptId: 1234567
        body:
          typeWebhook: "incomingMessageReceived"
          instanceData:
            idInstance: 1234,
            wid: "11001234567@c.us"
            typeInstance: "whatsapp"
          timestamp: 1588091580
          idMessage: "F7AEC1B7086ECDC7E6E45923F5EDB825"
          senderData:
            chatId: "79001234568@c.us"
            sender: "79001234568@c.us"
            senderName: "Green API"
          messageData:
            typeMessage: "textMessage"
            textMessageData:
              textMessage:"I use Green-API to send this message to you!"
    deleteNotificationRes:
      title: deleteNotification
      type: object
      required:
        - "result"
      properties:
        result:
          type: boolean
          description: "Incoming notification deleting result: true - incoming notification successfully deleted from the queue; false - notification is not deleted - possible, if the notification was deleted earlier or receiptId doesn't correspond to the value previously received by ReceiveNotification method"
      example:
        result: true

    ErrorModel:
      title: ErrorModel
      type: object
      required:
        - "number"
        - "timestamp"
        - "path"
        - "message"
      properties:
        statusCode:
          type: number
        timestamp:
          type: string
        path:
          type: string
        message:
          type: string
      example:
        statusCode: 400
        timestamp: "2023-05-14T09:19:01.738Z"
        path: "/waInstance1111111111/methods/xxx"
        message: "some error"
